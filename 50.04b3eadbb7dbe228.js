"use strict";(self.webpackChunkpolity=self.webpackChunkpolity||[]).push([[50],{7050:(T,v,t)=>{t.r(v),t.d(v,{FEATURE_ROUTES:()=>Z});var a=t(5861),o=t(1197),c=t(2351),u=t(2934),p=t(9259),g=t(6814),e=t(9212);function O(n,P){if(1&n){const i=e.EpF();e.TgZ(0,"button",1),e.NdJ("click",function(){const I=e.CHM(i).$implicit,C=e.oxw();return e.KtG(C.onClick(I))}),e.qZA()}if(2&n){const i=P.$implicit;e.s9C("tuiHint",i.text),e.Q6J("badge",i.badge)("icon",i.icon)("routerLink",i.link),e.uIk("data-cy",i.dataCy)}}let s=(()=>{class n{constructor(){this.items=c.N7,this.activeItemIndex=1}onClick(i){i.badge=0}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["polity-second-bar-top"]],inputs:{items:"items"},standalone:!0,features:[e.jDz],decls:5,vars:1,consts:[["tuiTabBar","",3,"activeItemIndex","activeItemIndexChange"],["routerLinkActive","","tuiTabBarItem","",3,"badge","icon","routerLink","tuiHint","click"],["routerLinkActive","","tuiTabBarItem","",3,"badge","icon","routerLink","tuiHint"]],template:function(r,d){1&r&&(e.TgZ(0,"nav",0),e.NdJ("activeItemIndexChange",function(C){return d.activeItemIndex=C}),e.SjG(1,O,1,5,"button",2,e.x6l),e.qZA(),e.TgZ(3,"h1"),e._uU(4,"This is a dynamic top bar"),e.qZA()),2&r&&(e.Q6J("activeItemIndex",d.activeItemIndex),e.xp6(1),e.wJu(d.items))},dependencies:[u.JU,u.Mx,u.F4,u.YO,o.Bz,o.rH,o.Od,p.go,p.D,p.xn,p.t6,p.DM,g.ez],styles:["nav[_ngcontent-%COMP%]:before{box-shadow:none}nav[_ngcontent-%COMP%]{box-shadow:var(--tui-shadow-navigation);position:fixed;top:0;width:100%}button[_ngcontent-%COMP%]{margin:auto}"]})}return n})();function l(n,P){if(1&n){const i=e.EpF();e.TgZ(0,"button",1),e.NdJ("click",function(){const I=e.CHM(i).$implicit,C=e.oxw();return e.KtG(C.onClick(I))}),e.qZA()}if(2&n){const i=P.$implicit;e.s9C("tuiHint",i.text),e.Q6J("badge",i.badge)("icon",i.icon)("routerLink",i.link),e.uIk("data-cy",i.dataCyDesktop)}}let S=(()=>{class n{constructor(){this.items=c.A$,this.activeItemIndex=1}onClick(i){i.badge=0}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["polity-second-bar-side"]],inputs:{items:"items"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[["tuiTabBar","",3,"activeItemIndex","activeItemIndexChange"],["routerLinkActive","","tuiTabBarItem","",3,"badge","icon","routerLink","tuiHint","click"],["routerLinkActive","","tuiTabBarItem","",3,"badge","icon","routerLink","tuiHint"]],template:function(r,d){1&r&&(e.TgZ(0,"nav",0),e.NdJ("activeItemIndexChange",function(C){return d.activeItemIndex=C}),e.SjG(1,l,1,5,"button",2,e.x6l),e.qZA()),2&r&&(e.Q6J("activeItemIndex",d.activeItemIndex),e.xp6(1),e.wJu(d.items))},dependencies:[u.JU,u.Mx,u.F4,u.YO,o.Bz,o.rH,o.Od,p.go,p.D,p.xn,p.t6,p.DM,g.ez],styles:["nav[_ngcontent-%COMP%]:before{box-shadow:none}nav[_ngcontent-%COMP%]{box-shadow:var(--tui-shadow-navigation);position:fixed;bottom:0;height:100%;width:80px;display:grid}button[_ngcontent-%COMP%]{margin:auto;width:100%}"]})}return n})();var f=t(7250),h=t(7989),m=t(4457),y=t(9107),E=t(2705);let x=(()=>{class n{constructor(i,r,d,I,C,w){this.sessionStoreService=i,this.profileStoreService=r,this.profileService=d,this.route=I,this.profileCounterService=C,this.profileCountersStoreService=w,this.menuItemsProfile=c._z}ngOnInit(){var i=this;return(0,a.Z)(function*(){const r=i.route.snapshot.params.id,d=i.sessionStoreService.getSessionId();i.checkIsOwner(r,d),yield Promise.all([i.profileService.selectProfile(r),i.profileCounterService.selectProfileCounter(r)]),yield i.profileCounterService.checkIfFollowing()})()}ngOnDestroy(){this.profileStoreService.profile.resetObject(),this.profileCountersStoreService.profileCounters.resetObject()}checkIsOwner(i,r){r==i?(this.profileStoreService.profile.uiFlagStore.setUiFlagTrue("isOwner"),this.menuItemsProfile=c.au,this.menuItemsProfile[0].link="/profile/"+i,this.menuItemsProfile[1].link="/profile/"+i+"/edit",this.menuItemsProfile[2].link="/profile/"+i+"/follower/edit"):(this.profileStoreService.profile.uiFlagStore.setUiFlagFalse("isOwner"),this.menuItemsProfile=c._z,this.menuItemsProfile[0].link="/profile/"+i)}static#e=this.\u0275fac=function(r){return new(r||n)(e.Y36(f.I),e.Y36(h.$),e.Y36(m.d),e.Y36(o.gz),e.Y36(y.B),e.Y36(E.W))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["polity-profile"]],standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[[3,"items"]],template:function(r,d){1&r&&e._UZ(0,"polity-second-bar-top",0)(1,"router-outlet")(2,"polity-second-bar-side",0),2&r&&(e.Q6J("items",d.menuItemsProfile),e.xp6(2),e.Q6J("items",d.menuItemsProfile))},dependencies:[s,o.lC,S,g.ez],styles:["polity-second-bar-top[_ngcontent-%COMP%]{top:0;left:0;position:fixed}"]})}return n})();var F=t(9216);let U=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["polity-search"]],standalone:!0,features:[e.jDz],decls:3,vars:1,template:function(r,d){1&r&&(e.TgZ(0,"h1"),e._uU(1,"Suche in der POLITY Welt"),e.qZA(),e._UZ(2,"router-outlet")),2&r&&e.uIk("data-cy","search-instruction")},dependencies:[o.lC],styles:[".grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:stretch}@media screen and (max-width: 47.9625em){.grid-item[_ngcontent-%COMP%]{width:100%}}@media screen and (min-width: 48em){.grid-item[_ngcontent-%COMP%]{width:48%;margin:1%}}@media screen and (min-width: 64em){.grid-item[_ngcontent-%COMP%]{width:30%;margin:1%}}.center-grid[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;width:100%;height:50vh}"]})}return n})();var L=t(6848);const Z=[{path:"",component:F.O,loadChildren:()=>t.e(755).then(t.bind(t,2755)).then(n=>n.HOME_ROUTES)},{path:"search",component:U,loadChildren:()=>t.e(82).then(t.bind(t,4082)).then(n=>n.SEARCH_ROUTES)},{path:"profile/:id",component:x,loadChildren:()=>Promise.all([t.e(450),t.e(592),t.e(635)]).then(t.bind(t,9635)).then(n=>n.PROFILE_ROUTES)},{path:"home",component:F.O,loadChildren:()=>t.e(755).then(t.bind(t,2755)).then(n=>n.HOME_ROUTES)},{path:"new",component:L.q,loadChildren:()=>t.e(402).then(t.bind(t,8402)).then(n=>n.NEW_ROUTES)},{path:"office",component:(()=>{class n{constructor(){this.menuItemsProfile=c.Zw}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["polity-office"]],standalone:!0,features:[e.jDz],decls:4,vars:3,consts:[[3,"items"]],template:function(r,d){1&r&&e._UZ(0,"polity-second-bar-top",0)(1,"h1")(2,"router-outlet")(3,"polity-second-bar-side",0),2&r&&(e.Q6J("items",d.menuItemsProfile),e.xp6(1),e.uIk("data-cy","office-instruction"),e.xp6(2),e.Q6J("items",d.menuItemsProfile))},dependencies:[s,o.lC,S]})}return n})(),loadChildren:()=>Promise.all([t.e(450),t.e(789)]).then(t.bind(t,789)).then(n=>n.OFFICE_ROUTES)}]},9216:(T,v,t)=>{t.d(v,{O:()=>s});var a=t(5861),o=t(9212),c=t(8890),u=t(1197);let p=(()=>{class l{constructor(f){this.router=f,this.sessionId=null,this.isLoading=(0,o.tdS)(!0),this.profile=(0,o.tdS)(null),this.dataCyTag="link-card"}onClick(){var f=this;return(0,a.Z)(function*(){yield f.router.navigate(["/profile/",f.sessionId])})()}static#e=this.\u0275fac=function(h){return new(h||l)(o.Y36(u.F0))};static#t=this.\u0275cmp=o.Xpm({type:l,selectors:[["polity-link-card"]],inputs:{sessionId:"sessionId",isLoading:"isLoading",profile:"profile",dataCyTag:"dataCyTag"},standalone:!0,features:[o.jDz],decls:3,vars:6,consts:[[3,"hoverable","click"],[1,"title","title_size_s"]],template:function(h,m){if(1&h&&(o.TgZ(0,"tui-island",0),o.NdJ("click",function(){return m.onClick()}),o.TgZ(1,"p",1),o._uU(2),o.qZA()()),2&h){let y;o.Q6J("hoverable",!0),o.xp6(1),o.ekj("tui-skeleton",m.isLoading()),o.uIk("data-cy",m.dataCyTag),o.xp6(1),o.AsE(" ",null==(y=m.profile())?null:y.first_name," ",null==(y=m.profile())?null:y.last_name," ")}},dependencies:[c.y,c.h],styles:[".title[_ngcontent-%COMP%]{font:var(--tui-font-heading-4);margin:2px}.title_size_s[_ngcontent-%COMP%]{font:var(--tui-font-heading-6)}"]})}return l})();var g=t(7250),e=t(4457),O=t(7989);let s=(()=>{class l{constructor(f,h,m){this.sessionStoreService=f,this.profileService=h,this.profileStoreService=m,this.profile=(0,o.tdS)(null),this.isProfileLoading=(0,o.tdS)(!0),this.isProfileLoading=this.profileStoreService.profile.loading.getLoading(),this.sessionId=this.sessionStoreService.getSessionId()}ngOnInit(){var f=this;return(0,a.Z)(function*(){yield f.profileService.selectProfile(f.sessionId),f.profile=f.profileStoreService.profile.getObject()})()}onDestroy(){this.profileStoreService.profile.resetObject()}static#e=this.\u0275fac=function(h){return new(h||l)(o.Y36(g.I),o.Y36(e.d),o.Y36(O.$))};static#t=this.\u0275cmp=o.Xpm({type:l,selectors:[["polity-home"]],standalone:!0,features:[o.jDz],decls:3,vars:8,consts:[[3,"dataCyTag","isLoading","profile","sessionId"]],template:function(h,m){1&h&&(o.TgZ(0,"h1"),o._uU(1," Dein Profil und Gruppen.\n"),o.qZA(),o._UZ(2,"polity-link-card",0)),2&h&&(o.uIk("data-cy","home-instruction"),o.xp6(2),o.ekj("tui-skeleton",m.isProfileLoading()),o.Q6J("dataCyTag","home-first-name")("isLoading",m.isProfileLoading)("profile",m.profile)("sessionId",m.sessionId),o.uIk("data-cy","home-to-profile"))},dependencies:[p]})}return l})()},6848:(T,v,t)=>{t.d(v,{q:()=>o});var a=t(9212);let o=(()=>{class c{static#e=this.\u0275fac=function(g){return new(g||c)};static#t=this.\u0275cmp=a.Xpm({type:c,selectors:[["polity-new"]],standalone:!0,features:[a.jDz],decls:2,vars:0,template:function(g,e){1&g&&(a.TgZ(0,"p"),a._uU(1,"new works!"),a.qZA())}})}return c})()},9107:(T,v,t)=>{t.d(v,{B:()=>g});var a=t(5861),o=t(225),c=t(9212),u=t(2705),p=t(7989);let g=(()=>{class e{constructor(s,l){this.profileCountersStoreService=s,this.profileStoreService=l,this.supabaseClient=o._}selectProfileCounter(s){var l=this;return(0,a.Z)(function*(){yield l.profileCountersStoreService.profileCounters.wrapSelectFunction((0,a.Z)(function*(){const S=yield l.supabaseClient.rpc("select_following_counter",{user_id:s}).single().throwOnError();S.data&&l.profileCountersStoreService.profileCounters.setObject(S.data)}))})()}checkIfFollowing(){var s=this;return(0,a.Z)(function*(){const l=s.profileCountersStoreService.profileCounters.getValueByKey("profile_id");yield s.profileCountersStoreService.profileCounters.wrapSelectFunction((0,a.Z)(function*(){s.profileStoreService.profile.uiFlagStore.setUiFlagTrue("isFollowingCheckLoading"),(yield s.supabaseClient.rpc("check_if_following",{following_id:l}).single().throwOnError()).data?s.profileStoreService.profile.uiFlagStore.setUiFlagTrue("isFollowing"):s.profileStoreService.profile.uiFlagStore.setUiFlagFalse("isFollowing"),s.profileStoreService.profile.uiFlagStore.setUiFlagFalse("isFollowingCheckLoading")}))})()}followProfile(){var s=this;return(0,a.Z)(function*(){const l=s.profileCountersStoreService.profileCounters.getValueByKey("profile_id");yield s.profileCountersStoreService.profileCounters.wrapUpdateFunction((0,a.Z)(function*(){yield s.supabaseClient.rpc("follow_transaction",{following_id:l}).throwOnError(),s.profileStoreService.profile.uiFlagStore.setUiFlagTrue("isFollowing"),s.profileCountersStoreService.profileCounters.incrementKey("follower_counter")}),!0,"Successful followed!")})()}unFollowProfile(){var s=this;return(0,a.Z)(function*(){const l=s.profileCountersStoreService.profileCounters.getValueByKey("profile_id");yield s.profileCountersStoreService.profileCounters.wrapUpdateFunction((0,a.Z)(function*(){yield s.supabaseClient.rpc("unfollow_transaction",{following_id:l}).throwOnError(),s.profileStoreService.profile.uiFlagStore.setUiFlagFalse("isFollowing"),s.profileCountersStoreService.profileCounters.decrementKey("follower_counter")}),!0,"Successful unfollowed!")})()}static#e=this.\u0275fac=function(l){return new(l||e)(c.LFG(u.W),c.LFG(p.$))};static#t=this.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},2705:(T,v,t)=>{t.d(v,{W:()=>c});var a=t(5226),o=t(9212);let c=(()=>{class u{constructor(){this.profileCounters=new a.N}static#e=this.\u0275fac=function(e){return new(e||u)};static#t=this.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);